<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浅谈 Word Embeddings | 叶子的技术碎碎念</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="叶子的技术碎碎念">
    
    <link rel="preload" href="/assets/css/0.styles.795fcb47.css" as="style"><link rel="preload" href="/assets/js/app.bd8004a5.js" as="script"><link rel="preload" href="/assets/js/7.d7dc3e09.js" as="script"><link rel="preload" href="/assets/js/2.d701f7d6.js" as="script"><link rel="preload" href="/assets/js/1.f54fd289.js" as="script"><link rel="preload" href="/assets/js/44.6ad8702d.js" as="script"><link rel="prefetch" href="/assets/js/10.79681363.js"><link rel="prefetch" href="/assets/js/11.29920769.js"><link rel="prefetch" href="/assets/js/14.b2cffd01.js"><link rel="prefetch" href="/assets/js/15.ba187924.js"><link rel="prefetch" href="/assets/js/16.1f560dd7.js"><link rel="prefetch" href="/assets/js/17.199dc857.js"><link rel="prefetch" href="/assets/js/18.b7c7ff02.js"><link rel="prefetch" href="/assets/js/19.04465c2e.js"><link rel="prefetch" href="/assets/js/20.4ba280e8.js"><link rel="prefetch" href="/assets/js/21.19e0a90d.js"><link rel="prefetch" href="/assets/js/22.79ef54ac.js"><link rel="prefetch" href="/assets/js/23.ba4ab7a0.js"><link rel="prefetch" href="/assets/js/24.afd714df.js"><link rel="prefetch" href="/assets/js/25.86016902.js"><link rel="prefetch" href="/assets/js/26.0a94d433.js"><link rel="prefetch" href="/assets/js/27.2768e2e4.js"><link rel="prefetch" href="/assets/js/28.c9fabea7.js"><link rel="prefetch" href="/assets/js/29.1e376621.js"><link rel="prefetch" href="/assets/js/3.bb090a50.js"><link rel="prefetch" href="/assets/js/30.129ca9e0.js"><link rel="prefetch" href="/assets/js/31.e32e2d81.js"><link rel="prefetch" href="/assets/js/32.79e0bedf.js"><link rel="prefetch" href="/assets/js/33.a9925ae6.js"><link rel="prefetch" href="/assets/js/34.b93dc917.js"><link rel="prefetch" href="/assets/js/35.2852e413.js"><link rel="prefetch" href="/assets/js/36.fb410a04.js"><link rel="prefetch" href="/assets/js/37.6bbe274a.js"><link rel="prefetch" href="/assets/js/38.1a1b315a.js"><link rel="prefetch" href="/assets/js/39.0e2e0de5.js"><link rel="prefetch" href="/assets/js/4.91310cca.js"><link rel="prefetch" href="/assets/js/40.7d41e87d.js"><link rel="prefetch" href="/assets/js/41.6d506318.js"><link rel="prefetch" href="/assets/js/42.384ae83a.js"><link rel="prefetch" href="/assets/js/43.848ec979.js"><link rel="prefetch" href="/assets/js/45.d9165949.js"><link rel="prefetch" href="/assets/js/46.7cf49e15.js"><link rel="prefetch" href="/assets/js/47.ab137e3c.js"><link rel="prefetch" href="/assets/js/48.23e89325.js"><link rel="prefetch" href="/assets/js/49.2e5727e6.js"><link rel="prefetch" href="/assets/js/5.ae9af707.js"><link rel="prefetch" href="/assets/js/50.e98bddca.js"><link rel="prefetch" href="/assets/js/51.a27effc2.js"><link rel="prefetch" href="/assets/js/52.ce7c3e96.js"><link rel="prefetch" href="/assets/js/53.959c70d1.js"><link rel="prefetch" href="/assets/js/6.ddc4768c.js"><link rel="prefetch" href="/assets/js/8.de91a9be.js"><link rel="prefetch" href="/assets/js/9.f7cbd4f5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.65214fb5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.795fcb47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>叶子的技术碎碎念</h3> <p class="description" data-v-59e6cb88>叶子的技术碎碎念</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">叶子的技术碎碎念</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  关于我
</a></div><div class="nav-item"><a href="/AI/courses/DeepLearning Specialization/01 Neural Networks and Deep Learning/深度学习与神经网络入门.html" class="nav-link"><i class="undefined"></i>
  人工智能
</a></div><div class="nav-item"><a href="/Java/Map.html" class="nav-link"><i class="undefined"></i>
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      叶子的技术碎碎念
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/careywyr" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2831954919569245" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>15</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  关于我
</a></div><div class="nav-item"><a href="/AI/courses/DeepLearning Specialization/01 Neural Networks and Deep Learning/深度学习与神经网络入门.html" class="nav-link"><i class="undefined"></i>
  人工智能
</a></div><div class="nav-item"><a href="/Java/Map.html" class="nav-link"><i class="undefined"></i>
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      叶子的技术碎碎念
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/careywyr" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2831954919569245" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Coursera深度学习专项课程</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AI/courses/DeepLearning Specialization/01 Neural Networks and Deep Learning/深度学习与神经网络入门.html" class="sidebar-link">深度学习与神经网络入门</a></li><li><a href="/AI/courses/DeepLearning Specialization/02 Improving Deep Neural Networks- Hyperparameter Tuning, Regularization and Optimization/Week1-blog.html" class="sidebar-link">深度学习实践基础</a></li><li><a href="/AI/courses/DeepLearning Specialization/02 Improving Deep Neural Networks- Hyperparameter Tuning, Regularization and Optimization/Week2-blog.html" class="sidebar-link">深度学习的优化算法</a></li><li><a href="/AI/courses/DeepLearning Specialization/02 Improving Deep Neural Networks- Hyperparameter Tuning, Regularization and Optimization/Week3-blog.html" class="sidebar-link">超参数调优、批量归一化以及深度学习框架</a></li><li><a href="/AI/courses/DeepLearning Specialization/03 Structuring Machine Learning Projects/BLOG.html" class="sidebar-link">机器学习策略详解</a></li><li><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week1 blog.html" class="sidebar-link">循环神经网络介绍</a></li><li><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week2 blog.html" class="active sidebar-link">浅谈 Word Embeddings</a></li><li><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week3 blog.html" class="sidebar-link">解密序列到序列模型：从机器翻译到语音识别</a></li><li><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week4 blog.html" class="sidebar-link">Transformer 网络解读</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>机器学习基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AI/机器学习/关联规则挖掘与Apriori算法.html" class="sidebar-link">关联规则挖掘与Apriori算法</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>浅谈 Word Embeddings</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">浅谈 Word Embeddings</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>叶子</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/8/19</span></i> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h2 id="word-embeddings-介绍"><a href="#word-embeddings-介绍" class="header-anchor">#</a> Word Embeddings 介绍</h2> <h3 id="词嵌入的概念"><a href="#词嵌入的概念" class="header-anchor">#</a> 词嵌入的概念</h3> <p>词嵌入是一种将词汇映射到密集向量的技术，这些向量捕捉词汇的语义和语法信息。在早期，我们用词汇表（vocabulary）和一个One-hot Vector 来表示词汇。比如，如果“man”是词典里的第5391个单词，那么我们就用一个在第5391位为1，其他位置都为0的向量来表示“man”。</p> <p>这种表示方式的缺点是，它把每个词看作一个孤立的实体，让学习算法难以在词之间进行泛化。比如说，模型学到了&quot;I want a glass of orange juice&quot;是一句可能的句子，那么它看到&quot;I want a glass of apple ...&quot;时，也能推测出下一个词可能是&quot;juice&quot;。但在one-hot向量表示下，&quot;apple&quot;和&quot;orange&quot;之间的关系对模型来说，和&quot;apple&quot;与&quot;man&quot;、&quot;woman&quot;、&quot;king&quot;、&quot;queen&quot;之间的关系没有区别。因为任何两个不同的one-hot向量的点积都是零，任何两个向量之间的距离也都是一样的。这就导致模型无法理解&quot;apple&quot;和&quot;orange&quot;比&quot;king&quot;和&quot;orange&quot;、&quot;queen&quot;和&quot;orange&quot;更相似。</p> <p>然而词嵌入通过连续的数值向量表示词汇，能够捕捉和表达词与词之间的相似性和关联性，比如，&quot;apple&quot;和&quot;orange&quot;的词嵌入向量会有很多相似的特征，因此模型能更快地从&quot;orange juice&quot;推断出&quot;apple juice&quot;。它能有效地改善模型对文本数据的理解能力，这对于很多NLP任务（如文本分类、情感分析、机器翻译等）都是非常关键的。</p> <h3 id="词嵌入的可视化"><a href="#词嵌入的可视化" class="header-anchor">#</a> 词嵌入的可视化</h3> <p>通过使用t-SNE算法（由Laurens van der Maaten和Geoff Hinton提出），我们可以把300维的词嵌入向量映射到二维空间进行可视化。可视化结果表明，词嵌入算法能学习到相关概念的相似特征，例如，词汇&quot;man&quot;和&quot;woman&quot;，&quot;king&quot;和&quot;queen&quot;等在二维空间中会被归类在一起。
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692198509885.png" alt=""></p> <p>我们把这些特征化表示在一个高维空间（如300维）中的位置称为“嵌入”，原因在于你可以想象一个高维空间，然后把每个词（比如&quot;orange&quot;）的三维特征向量嵌入到这个300维空间的某个点。</p> <h3 id="词嵌入在nlp中的应用背景"><a href="#词嵌入在nlp中的应用背景" class="header-anchor">#</a> 词嵌入在NLP中的应用背景</h3> <p>词嵌入技术已被广泛应用于各种NLP任务，比如命名实体识别（Named Entity Recognition）任务，举个例子：</p> <div class="language- extra-class"><pre class="language-text"><code>Sally Johnson is an orange farmer
Robert Lin is an apple farmer
</code></pre></div><p>我们需要“Sally Johnson ”是人名，如果我们将“orange farmer”中的“orange”替换为其他的水果，如“apple”，我们的算法应该能够推广到这种情况并正确地将“Robert Lin”识别为人名。甚至我们的模型可能推测出训练集未出现过的单词，比如durian farmer，词嵌入可以告诉我们durian也是一种水果。</p> <p>此外我们还可以利用词嵌入来进行<strong>迁移学习</strong>。步骤如下：</p> <ul><li>从大规模的文本语料库中学习词嵌入，或者下载预训练的词嵌入。</li> <li>将词嵌入迁移到新的任务中，在这个新的任务中，我们可能只有一个相对较小的标记训练集。</li> <li>使用这些词嵌入来表示我们的单词。例如，我们可以使用300维的词嵌入来代替10000维的one-hot向量。</li> <li>在新的任务上训练我们的模型。在训练过程中，我们可以选择继续微调词嵌入。</li></ul> <p>词嵌入在命名实体识别、文本摘要等任务都有很好的作用，但是对于语言模型和机器翻译等任务，如果我们有大量的数据，那么词嵌入的效果可能并不明显。这是因为迁移学习在我们有大量的任务A的数据和较小的任务B的数据时最有用。</p> <p>词嵌入和face encoding有一些相似之处。在面部识别中，我们会训练一个网络来学习一个128维的表示。然后，我们可以比较这些编码来判断这两张图片是否是同一张脸。在词嵌入中，我们也会学习一个固定的词嵌入，例如，我们可能会有一个固定的词汇表，包含10000个单词，我们会为每一个单词学习一个词嵌入。</p> <p><img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692199128665.png" alt=""></p> <h3 id="word-embeddings-的特点"><a href="#word-embeddings-的特点" class="header-anchor">#</a> Word embeddings 的特点</h3> <p>词嵌入可以帮助理解和建立类比关系，我们看下面这张表：
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692199459348.png" alt="">
“男人（man）之于女人（woman）就像国王（king）之于什么？”如果你有一个正确的词嵌入模型，答案将是“女王（queen）”。这是因为在词嵌入的向量空间中，“男人”与“女人”的向量差距主要表示性别的差异，同样，“国王”与“女王”的向量差距也表示性别的差异。其实这就是词嵌入（word embeddings）在<strong>类比推理</strong>（analogy reasoning）中的应用。</p> <p>词嵌入要做的是找到一个词w，使得<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="4" class="mjx-n"><mjx-c c="2248"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="k"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>，其中e_man、e_woman、e_king和e_w是词向量。这意味着“Man”和“Woman”之间的向量差距与“King”和词w之间的向量差距相似。这样的算法实际上是可以找到正确答案的，比如在这个例子中，它会找到“Queen”。</p> <p>最常用的相似度函数是余弦相似度（cosine similarity）。这个函数将两个向量u和v的内积除以它们的欧几里得长度。如果u和v非常相似，它们的内积会比较大，余弦相似度也就越接近1。余弦相似度实际上是向量u和v之间的角度的余弦值。如果角度为0，则余弦相似度为1；如果角度为90度，则余弦相似度为0；如果角度为180度，意味着它们完全朝反方向，那么余弦相似度为-1。
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692201206584.png" alt="">
word embeddings的另一个重要结果是它能学习的<strong>类比关系的泛化性</strong>。例如，它可以学习到“男人”之于“女人”就像“男孩”之于“女孩”，或者“渥太华”（加拿大的首都）之于“加拿大”就像“内罗毕”（肯尼亚的首都）之于“肯尼亚”，等等。这种模式可以通过在大型文本语料库上运行词嵌入学习算法自动学习。</p> <p>我们可以使用像t-SNE这样的算法将300维的数据映射到2D空间进行可视化，但需要注意，因为t-SNE是一种非线性映射，所以在2D空间中可能不能很好地保持原始300维空间中的类比关系。</p> <h3 id="embedding-matrix"><a href="#embedding-matrix" class="header-anchor">#</a> Embedding Matrix</h3> <p>当我们实现一个算法来学习词嵌入时，其实最终学习的是一个嵌入矩阵。举个例子，假设我们的词汇表有10000个单词，包括&quot;a&quot;, &quot;aaron&quot;... &quot;&lt;UNK&gt;&quot;等。
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692424979785.png" alt="">
我们将要学习一个嵌入矩阵E，这是300*10000的矩阵，这个矩阵的每一列都是词汇表中的10000个不同单词的嵌入向量。假设&quot;Orange&quot;这个单词的one-hot向量是<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="O"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="6"></mjx-c><mjx-c c="2"></mjx-c><mjx-c c="5"></mjx-c><mjx-c c="7"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container> ,如果将E与<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="O"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="6"></mjx-c><mjx-c c="2"></mjx-c><mjx-c c="5"></mjx-c><mjx-c c="7"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container> 相乘，那么就会得到一个300维的向量<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="6"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mn class="mjx-n"><mjx-c c="2"></mjx-c><mjx-c c="5"></mjx-c><mjx-c c="7"></mjx-c></mjx-mn></mjx-math></mjx-container>，表示单词&quot;Orange&quot;的300*1维的嵌入向量。
在学习词嵌入的过程中，这种通过使用嵌入矩阵和one-hot vector 提取特定词的嵌入的方式是非常重要的。</p> <h2 id="如何使用word-embeddings"><a href="#如何使用word-embeddings" class="header-anchor">#</a> 如何使用Word Embeddings</h2> <h3 id="词嵌入算法的学习"><a href="#词嵌入算法的学习" class="header-anchor">#</a> 词嵌入算法的学习</h3> <p>在深度学习应用于词嵌入的历史上，人们最初使用的是相对复杂的算法。但随着时间的推移，研究人员发现，即使使用更为简单的算法，特别是在大型数据集上，仍然能得到非常好的结果。
依然举个例子来辅助说明，假设我们需要使用神经网络构建一个语言模型，这个模型可以实现输入一句话然后预测序列的下一个单词，如&quot;I want a glass of orange (juice).&quot;
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692425542922.png" alt="">
构建语言模型的步骤可以这样来:</p> <ol><li>先取出句子中的单词，构建一个与单词对应的one-hot vector</li> <li>使用参数矩阵E和每一个one-hot vector相乘。我们可以得到一组嵌入向量，每个向量都是300维的。</li> <li>我们将得到的所有的嵌入向量放入伸进网络中，后续的网络会将这些向量输入到softmax分类器中，分类器会从词汇表中输出预测的最后的单词。</li> <li>如果在训练集中看到了&quot;juice&quot;这个单词，那么训练softmax分类器时，我们的目标其实就是得到&quot;juice&quot;这个单词。</li> <li>每个隐藏层都有自己的参数,我们称为<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="W"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container> softmax也有自己的参数<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="W"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>.如果使用300维的词嵌入，那么6个单词得到这一层的输入将是18000维的向量。</li> <li>但这个方法显然会由于句子长度导致这个向量很大，因此有一个更常见的做法就是使用一个固定的历史窗口，比如这个窗口是4，那就表示总是根据前四个词来预测下一个词，这个4是算法的超参数，这样我们可以处理任意长度的句子，因为窗口大小是固定的，注意我们不用给这四个单词的不同位置使用不同的参数矩阵E。</li></ol> <p>此外再举一个复杂的句子，训练集有这样一句话： &quot;I want a glass of orange juice to go along with my cereal.&quot;
<img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692426676192.png" alt="">
我们的问题不像是前一个通过前面单词预测下一个单词，而是根据目标词的左右四个词类预测中间的词，这种方法也可以用来学习词嵌入。另外还有更简单的学习问题，比如通过“juice”反向预测“orange”，也可以得到很好的结果。
后面我们还会讲解的skip-gram model, Negative sampling 都是有效的学习word embedding方法。</p> <h3 id="word2vec"><a href="#word2vec" class="header-anchor">#</a> Word2Vec</h3> <p>Word2Vec算法是一个简单且高效的学习 word embedding 的方法，其中的一个主要模型叫做 skip-gram 模型，主要是通过创建监督学习问题的上下文和目标对来实现的。这个模型并不是要完美地解决监督学习问题，而是通过这个问题学习出好的 embedding。</p> <p>在skip-gram模型中，我们首先随机选择一个<strong>上下文词</strong>（context word），比如&quot;orange&quot;，然后我们会在这个词的某个窗口范围内（比如前后5或10个词）随机选择一个<strong>目标词</strong>（target word）。我们的监督学习问题就是，给定上下文词，预测在一定范围内的随机选择的词是什么。</p> <p>假设我们有一个包含10000个词的词汇表。我们要学习的是如何从某个上下文词映射到某个目标词。为了表示输入（例如单词“orange”），我们可以使用一个one-hot vector，然后乘以嵌入矩阵E，得到输入上下文词的嵌入向量。我们将这个向量馈入到一个softmax单元，得到输出y_hat。然后我们就可以通过softmax的损失函数优化所有的这些参数，得到一组好的嵌入向量。</p> <p><img src="https://leafw-blog-pic.oss-cn-hangzhou.aliyuncs.com/1692427351374.png" alt=""></p> <p>这个算法的主要问题是计算速度。对于softmax模型，我们需要在所有的词汇中进行求和，这在词汇表较大时会变得非常慢。为了解决这个问题，我们可以使用分层softmax分类器（hierarchical softmax classifier）或者负采样（negative sampling）方法。</p> <p>此外，选择上下文词（context word）的方法也是一个值得关注的话题。如果我们随机选择，那么常见的词（如“the”、“of”、“a”、“and”、“to”等）会非常频繁地出现，这可能会使得你的训练对偶主要由这些词组成。为了解决这个问题，我们可以使用不同的启发式方法来平衡常见词和不常见词的出现。</p> <h3 id="负采样-negative-sampling"><a href="#负采样-negative-sampling" class="header-anchor">#</a> 负采样 (Negative Sampling)</h3> <p>负采样的出现是为了解决Softmax计算代价过大的问题。负采样的基本思想是通过构造一个新的有监督学习问题来学习词嵌入。</p> <p>具体来说，我们可以将一个词对（例如，“orange”和“juice”）视为一个正例，并标记为1，同时从词典中随机选择一个词（例如，“king”）与“orange”组成一个负例，并标记为0。这样，我们就构造出了一个新的监督学习问题：给定一个词对，我们需要预测这是一个上下文-目标词对（标签为1）还是一个随机词对（标签为0）。</p> <p>用数学语言描述就是，给定一对词<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>（分别表示上下文词和目标词），以及标签<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-TeXAtom space="4"><mjx-mn class="mjx-n"><mjx-c c="0"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mn space="2" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-math></mjx-container>，我们可以通过逻辑回归模型来预测<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn space="4" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-math></mjx-container>的概率。模型的具体表达式为：
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn space="4" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="3C3"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msubsup><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3B8"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.247em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi><mjx-spacer style="margin-top:0.217em;"></mjx-spacer><mjx-mi size="s" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container></p>
其中，<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3B8"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>是目标词<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>的参数向量，<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>是上下文词<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi></mjx-math></mjx-container>的嵌入向量，<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C3"></mjx-c></mjx-mi></mjx-math></mjx-container>是sigmoid函数。<p></p> <p>这样，我们就将一个10,000维的Softmax问题，转化为了10,000个二分类问题，每个问题都是一个逻辑回归。在每次迭代中，我们只需要更新一部分的分类器，具体来说，就是一个正例对应的分类器，和<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="k"></mjx-c></mjx-mi></mjx-math></mjx-container>个随机选择的负例对应的分类器。这样，就大大降低了计算的复杂度。</p> <p>瓷碗，如何选择负例也是一个关键的问题，如果我们直接按照语料库中词的频率来采样，那么常见词（如“the”、“of”、“and”等）的出现频率会过高。反之，如果我们均匀地随机选择词，那么选择到的词可能并不能很好地反映实际的语言分布。我们可以使用一种这种的方式，按照次品的四分之三次方进行采样：
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="W"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="3"></mjx-c></mjx-mn><mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c c="/"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c c="4"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-munderover limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-spacer style="margin-top:0.276em;"></mjx-spacer><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-munderover><mjx-mi space="2" class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="3"></mjx-c></mjx-mn><mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c c="/"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c c="4"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></p>
其中，<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>表示词<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>在语料库中的频率，<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-munderover limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-spacer style="margin-top:0.284em;"></mjx-spacer><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="0"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-munderover><mjx-mi space="2" class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="3"></mjx-c></mjx-mn><mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c c="/"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c c="4"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup></mjx-math></mjx-container>是一个归一化因子，保证所有词的采样概率之和为1。这种方式虽然缺乏理论支持，但在实践中表现良好，已经被许多研究者采用。<p></p> <p>负采样是一种高效的词嵌入学习算法，通过将一个多分类问题转化为多个二分类问题，显著减小了计算复杂度。虽然我们可以自行训练词嵌入，但在许多情况下，直接使用开源的预训练词嵌入是一个更快的解决方案。</p> <h3 id="glove-word-vectors"><a href="#glove-word-vectors" class="header-anchor">#</a> Glove Word Vectors</h3> <p>接下再介绍一种在NLP社区中具有一些影响力的word embedding计算算法-GloVe算法。尽管GloVe算法没有像Word2Vec或skip-gram模型那样被广泛使用，但它依然拥有一些热衷的支持者，主要是因为它的简单性。</p> <p>它的主要概念是根据全局词频统计信息来生成词向量，它定义了一个共现矩阵X，其中<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="X"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>表示词i在词j的上下文中出现的次数，表示了两个词一起出现的频率。
Glove的目标是优化一个目标函数如下所示，使得词向量的内积能很好的预测两个词在一起出现的频率。对于出现频率为0的词对，定义log0=0。
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class="MJX-TEX"><mjx-munderover><mjx-over style="padding-bottom:0.184em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style="padding-left:0.162em;"><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.31em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover space="2"><mjx-over style="padding-bottom:0.184em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style="padding-left:0.162em;"><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.286em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi space="2" class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="X"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msubsup><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3B8"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.247em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi><mjx-spacer style="margin-top:0.193em;"></mjx-spacer><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.247em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo><mjx-spacer style="margin-top:0.223em;"></mjx-spacer><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-n"><mjx-c c="l"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="g"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2061"></mjx-c></mjx-mo><mjx-TeXAtom space="2"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="X"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom><mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-script style="vertical-align:0.413em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container></p>
对于词频非常高或者非常低的词，GloVe使用了一个权重函数f来平衡他们的贡献，避免让常见词过度占据权重，同时保证不常见词也有一定的权重。在训练过程中，对于每个词，GloVe会生成两组词向量θ和e，然后取平均值作为最终的词向量。这是因为在GloVe中，θ和e扮演了对称的角色。<p></p> <p>GloVe的一个优点是，它能够明确地利用全局统计信息，一次考虑所有的共现统计数据。相比之下，Word2Vec模型一次只考虑一个上下文窗口。但在处理词义消歧和OOV（词汇表外的词）问题上，GloVe还存在一些局限性。例如，它不能为一个词的不同含义生成不同的词向量；对于未知词，只能分配一个共享的嵌入向量。</p> <p>尽管GloVe存在一些问题，但它为自然语言处理提供了一种有效的词嵌入计算方法，并激发了许多研究工作来进一步改进这种方法。</p> <h2 id="word-embeddings-的应用"><a href="#word-embeddings-的应用" class="header-anchor">#</a> Word Embeddings 的应用</h2> <h3 id="情感分类-sentiment-classification"><a href="#情感分类-sentiment-classification" class="header-anchor">#</a> 情感分类 (Sentiment classification)</h3> <p>情感分类是NLP中最重要的基础模块之一，其任务是根据文本内容确定其情感倾向，如喜欢或不喜欢某事物。尽管数据标注的挑战存在，但通过词嵌入技术，我们仍然可以使用规模适中的标签训练集来构建有效的情感分类器。</p> <p>情感分类的一个应用例子是预测餐厅的星级评分。通过训练一个系统，将评论（X）映射为星级评分（Y），可以用于监控人们对你的餐厅的评论，从而了解餐厅的表现情况。</p> <p>下面是使用词嵌入构建情感分类器的两种算法：</p> <ol><li><strong>简单的情感分类模型：</strong> 对句子中的每个词在字典中进行查找，然后找到其一位有效编码，并通过嵌入矩阵将其转换为嵌入向量。这个嵌入矩阵可能是从大规模的文本语料库（例如100亿词）中学习得来的。然后，将这些嵌入向量进行求和或平均，以得到一个300维的特征向量，将其传入softmax分类器，从而得出预测结果。这种方法适用于各种长度的评论，但其问题是它忽略了词序，可能会误判含有大量正面词汇的负面评论。</li> <li><strong>使用RNN的情感分类模型：</strong> 除了将句子中的每个词转化为嵌入向量外，我们还可以将这些嵌入向量作为RNN的输入。RNN将在最后一个时间步长计算出表示，用于预测结果。这种模型可以更好地考虑到词序，避免了简单模型中的问题。</li></ol> <p>这两种模型都可以利用词嵌入对大规模未标记数据中的信息进行编码，并将这些信息应用到小规模的标签训练集中，从而提高情感分类的效果。</p> <h3 id="消除偏见"><a href="#消除偏见" class="header-anchor">#</a> 消除偏见</h3> <p>机器学习和AI算法正在越来越多地被信任，用来帮助或做出极其重要的决策。所以我们要尽可能地确保它们不带有不良的偏见，比如性别偏见、种族偏见等。word embeddings 可以学习出类比，如 &quot;man is to woman as king is to queen&quot;（男人之于女人如同国王之于王后），但是有时候它也可能输出不良的类比，比如 &quot;man is to computer programmer as woman is to homemaker&quot;（男人之于程序员如同女人之于家庭主妇）。这样的结果显然是不公正的，而且强化了不健康的性别刻板印象。</p> <p>词嵌入可以反映出训练模型所用文本的性别、种族、年龄、性取向等偏见。因为机器学习算法正在被用来做出很重要的决定，例如大学录取、工作找寻、贷款申请、甚至是刑事司法系统的量刑指南等，所以尽可能减少或消除这些不良偏见非常重要。</p> <p>词嵌入偏见减少的步骤大概如下所示：</p> <ol><li>首先，识别出我们想要减少或消除的特定偏见的方向。比如，在处理性别偏见时，我们可以通过计算&quot;he&quot;（他）和&quot;she&quot;（她）等词的嵌入向量差值的平均值，来找出性别偏见的方向。</li> <li>进行&quot;中和&quot;步骤，对于非定义性的词，将其投影以消除偏见。比如，&quot;doctor&quot;（医生）和&quot;babysitter&quot;（保姆）这样的词我们希望是性别中性的，所以我们将其投影到无关偏见的方向。</li> <li>进行&quot;均衡&quot;步骤，对于一些词对（如grandmother-grandfather, girl-boy），我们希望他们的嵌入只在性别方面有差异。最后的&quot;均衡&quot;步骤就是确保像&quot;grandmother&quot;（祖母）和&quot;grandfather&quot;（祖父）这样的词与应该是性别中性的词（如&quot;babysitter&quot;（保姆）或&quot;doctor&quot;（医生））的相似性或距离完全一样。</li></ol> <p>综上，本文的主要围绕Word Embeddings展开了一系列的知识点的介绍，包括它的概念，常见算法，使用场景等。这些知识点很多都是出自于一些经典的论文中，希望有空可以仔细阅读一下原文，才能更好的理解和掌握它们。</p> <h2 id="附录-相关文献"><a href="#附录-相关文献" class="header-anchor">#</a> 附录-相关文献</h2> <ol><li>Van der Maaten L, Hinton G. Visualizing data using t-SNE[J]. Journal of machine learning research, 2008, 9(11).</li> <li>Taigman Y, Yang M, Ranzato M A, et al. Deepface: Closing the gap to human-level performance in face verification[C]//Proceedings of the IEEE conference on computer vision and pattern recognition. 2014: 1701-1708.</li> <li>Taigman Y, Yang M, Ranzato M A, et al. Deepface: Closing the gap to human-level performance in face verification[C]//Proceedings of the IEEE conference on computer vision and pattern recognition. 2014: 1701-1708.</li> <li>Bengio Y, Ducharme R, Vincent P. A neural probabilistic language model[J]. Advances in neural information processing systems, 2000, 13.</li> <li>Mikolov T, Chen K, Corrado G, et al. Efficient estimation of word representations in vector space[J]. arXiv preprint arXiv:1301.3781, 2013.</li> <li>Mikolov T, Sutskever I, Chen K, et al. Distributed representations of words and phrases and their compositionality[J]. Advances in neural information processing systems, 2013, 26.</li> <li>Pennington J, Socher R, Manning C D. Glove: Global vectors for word representation[C]//Proceedings of the 2014 conference on empirical methods in natural language processing (EMNLP). 2014: 1532-1543.</li> <li>Bolukbasi T, Chang K W, Zou J Y, et al. Man is to computer programmer as woman is to homemaker? debiasing word embeddings[J]. Advances in neural information processing systems, 2016, 29.</li></ol></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week1 blog.html" class="prev">
          循环神经网络介绍
        </a></span> <span class="next"><a href="/AI/courses/DeepLearning Specialization/05 Sequence Models/Week3 blog.html">
          解密序列到序列模型：从机器翻译到语音识别
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.bd8004a5.js" defer></script><script src="/assets/js/7.d7dc3e09.js" defer></script><script src="/assets/js/2.d701f7d6.js" defer></script><script src="/assets/js/1.f54fd289.js" defer></script><script src="/assets/js/44.6ad8702d.js" defer></script>
  </body>
</html>
